# H2A_DialogLoader

このプラグインは、「文章の表示」をはじめとしたセリフデータをテキストで管理できるようにすることを目的にしたプラグインです。

これを使うことで、スクリプトでノベルゲームを作るような感覚でセリフを書くことができます。

また、書いたセリフデータはイベントコマンドの好きなタイミングに挿入することができるので、様々な応用ができます。

## チュートリアル

### 導入準備

まず、ゲームプロジェクトの index.html があるフォルダ内に `dialogs` という名前のフォルダを作ってください。

次に、そのフォルダの中に `hello.txt` というテキストファイルを作ってください。（文字コードは UTF-8 にしてください）

テキストファイルには以下の「ダイアログスクリプト」をコピペして保存してください。

```
# CONFIG {"name": "あなた"}

こんにちは、世界！
こんにちは、世界！
こんにちは、世界！
こんにちは、世界！

これはチュートリアルで作ったダイアログスクリプトです。これが表示されたということは、成功です！
```

### プラグインを使用する

プロジェクトのプラグイン設定で H2A_DialogLoader を有効化してください。

それが終わったら、空のマップを作成して適当な歩行イベントを作りましょう。

そのイベントのコマンドエディタを開き、「プラグインコマンド...」を追加します。

プラグイン名から「H2A_DialogLoader」を選び、コマンド名を「実行」にします。

引数の「ファイルパス」を「hello」に設定してください。この「hello」は、先程 dialogs に作成した hello.txt のことです！

終わったらゲームを保存し、テストプレイで先程作った歩行イベントの処理を実行してみましょう！

セリフが表示されたら、成功です！

## ダイアログスクリプト リファレンス

### 注釈

```
--- このように書いた行は無視されます
```

### 文章の表示

```
このように
書くことで
４行まで文章を
表示することができます

また、このように１行で書くことによって、表示しきれない分の文字列が自動で改行されます。

改行される基準となる文字数は「# CONFIG {"wrapLength": 60}」という具合に設定できます。
```

### `# CONFIG` 設定の変更

顔グラフィックや表示名、文章窓の背景や位置などの設定を変更します。

```
--- この {} 部分に JSON で変更したい表示設定を書き込む
# CONFIG {}

--- このようにすることで、顔グラフィックと表示名を変更できます
# CONFIG {"face": ["Actor1", 0], "name": "アレックス"}
```

```js
// 設定項目一覧
{
  face: ["", 0], // 顔グラフィックのファイル名とインデックス
  name: "", // 表示名
  background: 0, // 背景 (0 = 通常, 1 = 黒, 2 = 透明)
  position: 2, // 位置 (0 = 上, 1 = 中央, 2 = 下)
  choicePosition: 2, // 選択肢の位置 (0 = 左, 1 = 中央, 2 = 右)
  choiceDefault: -1, // 選択肢のデフォルト (-1 = なし, 0-5 = 選択肢)
  wrapLength: 60, // 自動で折り返す場合の１行ごとの半角文字数
  bgmDefault: { volume: 100, pitch: 100, pan: 0 }, // BGM再生のデフォルト設定
  bgsDefault: { volume: 100, pitch: 100, pan: 0 }, // BGS再生のデフォルト設定
  meDefault: { volume: 100, pitch: 100, pan: 0 }, // ME再生のデフォルト設定
  seDefault: { volume: 100, pitch: 100, pan: 0 }, // SE再生のデフォルト設定
}
```

### `# ACTOR` アクターの名前・顔グラに変更

IDまたは名前で指定した、データベースにて設定されているアクターの名前と顔グラフィックに変更することが出来ます。

```
--- データベースに「アレックス」として登録されているキャラクターの名前と顔グラフィックに変更
# ACTOR アレックス

--- 数字を引数にすると ID 指定になる
# ACTOR 2
```

### `# WAIT` ウェイト

ウェイト処理を実行します。

```
--- 60 フレーム待つ
# WAIT 60
```

### `# COMMON_EVENT` コモンイベントの呼び出し

コモンイベントを名前指定で呼び出します

```
--- コモンイベント名「フラッシュ」を実行
# COMMON_EVENT フラッシュ
--- コモンイベント名「立ち絵 主人公 怒り」を実行
# COMMON_EVENT 立ち絵 主人公 怒り
```

### サウンドの再生/停止

BGM, BGS, ME, SE を再生・停止します。

```
--- BGM「Battle1」を再生
# BGM {"name": "Battle1"}
--- このように音量・ピッチ・定位の設定も可能
# BGM {"name": "Battle1", "volume": 90, "pitch": 50, "pan": 0}
--- 止めたい場合
# BGM STOP

--- 以上の引数の入力方法は、BGS, ME, SE でも同様

--- BGS を再生
# BGS {"name": "Sea"}
--- ME を停止
# ME STOP
--- SE を再生
# SE {"name": "Slash5", "pitch": 75}
```

### マクロの設定/実行

１行のマクロを登録し、実行することができます。

```
--- マクロ名「アレックス」として、顔グラフィックと表示名を変更する処理を登録
# DEF アレックス # CONFIG {"face": ["Actor1", 0], "name": "アレックス"}
--- マクロ名「ブライアン」として、顔グラフィックと表示名を変更する処理を登録
# DEF ブライアン # CONFIG {"face": ["Actor2", 0], "name": "ブライアン"}
--- マクロ名「爆発音」として、効果音「Thunder6」を再生する処理を登録
# DEF 爆発音 # SE {"name": "Thunder6", "volume": 100}

--- 「# CALL マクロ名」のように書くことで、上で定義したマクロを呼び出せる
# CALL アレックス
話は聞かせてもらった！
人類は滅亡する！
# CALL 爆発音
# CALL ブライアン
な、なんだってー！！
```

### ラベル

ラベルを指定し、飛ばすことができます。

```
--- この位置にラベル「無限ループ」を設置
# LABEL 無限ループ

このようにすると、
無限にこの文章が表示される

--- ラベル「無限ループ」にジャンプ
# GOTO 無限ループ
```

### 上級者向け機能

#### `# EXEC` JavaScript を実行

```
--- ID:5 の変数に 100 を代入
# EXEC $gameVariables.setValue(5, 100);

変数 5 番の中身は \v[5] です。
```

#### `# GOTO_IF` JavaScript の結果と同名のラベルに飛ぶ

```
--- 変数 1 が 100 だったらラベル「あ」に飛ぶ
--- そうでない場合は「い」に飛ぶ

# GOTO_IF $gameVariables.value(1) === 100 ? "あ" : "い"

# LABEL あ

100だったよ！

# LABEL い
```

#### `# INSERT` 任意のイベントコマンドを実行

```
--- {"code": 230, "parameters": [120]} (ウェイト: 120) を実行
# INSERT [230, [120]]
```
